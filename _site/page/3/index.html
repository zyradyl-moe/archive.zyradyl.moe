<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="UTF-8">

  <!-- Enable responsiveness on mobile devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Home - page 3 &middot; Bit of A Byte
    
  </title>

  
  <!-- canonical link -->
  <link rel="canonical" href="/page/3/index.html">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Dosis">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">

  <!-- Icons -->
  <!-- <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png"> -->
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Google Analytics -->
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-130197091-1', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>My name is Natalie and I spend most of my time taking apart things I have no business taking apart.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/projects/">Projects</a>
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/site/">Site Information</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/tags/">Tags</a>
        
      
    

    <a class="sidebar-nav-item" href="https://github.com/zyradyl/zyradyl.github.io">Currently v0.6.0</a>
  </nav>

  <div class="sidebar-item">
    <p>
      <a href="https://creativecommons.org/publicdomain/zero/1.0/">
        Ø 2018 - No Rights Reserved.
      </a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            
                
            <small><a href="http://127.0.0.1">$USER</a>@<a href="/" title="Home">bit-of-a-byte</a>
         ~ $ cat $(find /var/log -name '*.log' -print | awk 'NR>10&amp;&amp;NR&lt;=15')</small>
            
            </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/02/An-Actual-Update/">
        An Actual Update
      </a>
    </h1>

    <span class="post-date">02 Dec 2015</span>

    <p>So I recently purchased a new MacBook Pro, and in the time it took me to get the
device, add in all my new stuff, migrate everything over, establish a new
backup system, and contend with school work, this blog ended up becoming very
neglected. It didn’t help matters much when I logged on from Safari and
realised none of my fonts were working properly.</p>

<p>I believe I have now solved the font issue (woff files vs woff2 files), and I
have completed all the setup of this system, including getting my ruby workflow
transitioned. So, in theory, we will be able to get back to the good stuff here
shortly.</p>

<p>I have recently joined a small game development startup with some very talented
people, and was berated into using C++ for the game by the way this particular
industry works, so you can expect some future posts about my frustrations with
developing a cross platform game engine in C++.</p>

<p>The goal, for now, is to do the following:</p>

<ul>
  <li>Write a post on backup software evaluation, and why I went with the software
I did go with.</li>
  <li>Finish up the Icinga2 Tutorials that have driven quite a lot of traffic to
this page.</li>
  <li>Write some stuff on game design.</li>
</ul>

<p>So we will see how that works out. As always, thanks for reading.</p>

<p>P.S. I have decided that I don’t really like having analytics on this page,
so over the next few days I am going to root through the code and remove them.
Thank you for your patience.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/09/07/Blog-Cleanup/">
        Blog Cleanup
      </a>
    </h1>

    <span class="post-date">07 Sep 2015</span>

    <p>I just spent the past thirty minutes going back and removing a number of the
links that were in my posts up to this point. Nothing important, just links
to Wikipedia or Man Pages, but after speaking with a few friends, I realized
the links weren’t exactly as useful as I thought they were. In addition to this
my build time on Travis-CI had hit about four minutes and all I have to build
is about eight pages, so that’s absurd, and not really scalable. All the
important links have been left in, along with any interesting or amusing ones.</p>

<p>If you are looking for the links, you can go into the github repository for
this site, and look for the commits prior to “Automatic Commit: cleaning up
links”.</p>

<p>This also helps to maintain my sanity, so there’s that. Fifty links in one
article was causing me to worry quite a lot about dead links.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/09/07/Icinga2-Tutorial-Part-4/">
        Icinga2 Tutorial Part 4 - Expanding Checks to SNMP
      </a>
    </h1>

    <span class="post-date">07 Sep 2015</span>

    <ul>
  <li><a href="/2015/08/10/Icinga2-Tutorial-Part-0/">Icinga2 Tutorial: Part 0 - Network Monitoring for the Masses</a></li>
  <li><a href="/2015/08/11/Icinga2-Tutorial-Part-1/">Icinga2 Tutorial: Part 1 - Installation and Configuration</a></li>
  <li><a href="/2015/08/12/Icinga2-Tutorial-Part-2/">Icinga2 Tutorial: Part 2 - Agent-Less Checks</a></li>
  <li><a href="/2015/08/17/Icinga2-Tutorial-Part-3/">Icinga2 Tutorial: Part 3 - Agent-Based Checks</a></li>
</ul>

<p><strong>EDIT (2018/12/09):</strong> <em>These guides haven’t been updated since 2015. It is
possible that there are dead links, or that the configuration syntax has changed
dramatically. These posts are also some of the most popular on my blog. I plan
to do a new guide eventually, but for right now please take the following
entries with a grain of salt.</em></p>

<h2 id="introduction">Introduction</h2>
<p>Well I have finally persuaded myself to continue writing these posts by
completely deleting all the configuration I had already set up. It is worth
noting that I have switched over to Debian Jessie, for no other reason than
to cause myself more <a href="http://jimlynch.com/linux-articles/the-psychology-of-a-distrohopper/">frustration and suffering</a>. Anyways, let’s get started.</p>

<p>SNMP is considered an <a href="http://docs.icinga.org/icinga2/latest/doc/module/icinga2/toc#!/icinga2/latest/doc/module/icinga2/chapter/agent-based-checks-addon">Agent-Based Check</a>, and is actually quite
flexible. You can even go as far as to code in custom return options, to check
things you normally wouldn’t be able to check over snmp, for example,
<a href="https://wiki.icinga.org/display/howtos/check_apt+via+SNMP">apt status</a>, and other such things.</p>

<p>It is worth noting that due to using a very small LAN, I will not be
fiddling around with SNMPv3, I will be going with straight SNMPv1,
just with a modified community string. We will get started with my core
router, Djehuti. It is outside the scope of this tutorial to discuss
how to enable SNMP on your device, but if you use a Ubiquiti device,
hey that might come soon.</p>

<p>Starting from this post forward, I will be embedding code here instead of
referring to an external link, as embedding will encourage me to be a bit more
complete in my explanations. So, with all of that said, let’s get started.</p>

<h2 id="initial-setup">Initial Setup</h2>
<p>To monitor SNMP we will be using the <a href="http://nagios.manubulon.com/">Manubulon SNMP Plugins</a>. So we first
need to install them.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zyradyl@captor:~$ sudo apt-get install nagios-snmp-plugins
</code></pre></div></div>

<p>Now we need to open up the main Icinga2 Configuration file and add in the
proper include to allow us to use these plugins. You may notice while poking
around this file that there are many things you either don’t need or would like
to change. I do plan to come back to this file at a later time, but feel free to
edit this file before that happens. Once you have made the proper changes,
restart Icinga2 so the new settings take effect.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zyradyl@captor:~$ sudo vim /etc/icinga2/icinga2.conf

    include &lt;manubulon&gt;

zyradyl@captor:~$ sudo service icinga2 restart
</code></pre></div></div>

<p>With that, we can move on to creating configuration files!</p>

<h2 id="djehuti">Djehuti</h2>
<p>We will be starting with my core router, which is running SNMPv1. The first
thing we will want to do is to add some essential variables to our host
directive so that we don’t have to redefine them with every service.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//
// Host Declaration Block
//
object Host "djehuti.zyradyl.org" {
    // Define the host IPv4 Address
    address             = "10.0.0.1"
    // Define a basic functionality test
    // Hostalive does a basic ICMP ECHO to the target
    // specified in the address directive.
    check_command       = "hostalive"
    // Define SNMP Variables
    vars.snmp_address   = "10.0.0.1"
    vars.snmp_community = "zyradyl"
    // These are not strictly needed. I add them
    // so I know at a glance what version of snmp
    // I am using.
    vars.snmp_v2        = "false"
    vars.snmp_v3        = "false"
}
</code></pre></div></div>

<p>The new additions are any of the <code class="highlighter-rouge">var.snmp*</code> commands located under the
<code class="highlighter-rouge">check_command</code> line. With our host variables set up, we can now move on to
defining a service. The first service defined in the
<a href="http://docs.icinga.org/icinga2/latest/doc/module/icinga2/toc#!/icinga2/latest/doc/module/icinga2/chapter/plugin-check-commands#snmp-manubulon-plugin-check-commands">Icinga2 Manubulon Documentation</a> is the <code class="highlighter-rouge">snmp-load</code> check. Seems like a
good starting place to me!</p>

<h3 id="snmp-load">SNMP-Load</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//    
// Service Declaration Block
// Service:     snmp_load
// Description: Uses SNMP commands to check the load averages
//              on the device.
//
object Service "snmp-load" {
    host_name           = "djehuti.zyradyl.org"
    // Set the type of load check to use.
    vars.snmp_load_type = "netsl"
    // Set the Load Average warning threshold.
    vars.snmp_warn      = "5,3,2"
    // Set the Load Average critical threshold.
    vars.snmp_crit      = "6,5,3"
    check_command       = "snmp-load"
}
</code></pre></div></div>

<p>I feel I should take a minute to explain the warning and critical variables,
because the icinga2 documentation doesn’t do a very good job. When checking
load averages on *nix systems, there are three parameters:</p>

<ul>
  <li>Average Load over one minute</li>
  <li>Average Load over five Minutes</li>
  <li>Average Load over fifteen minutes</li>
</ul>

<p>Since my router is a dual core device, I have set it up so that if the system
is at full load for 15 minutes, I get a warning. If it has one process over
full load for five minutes, I get a warning. If it is three processes over full
load in one minute, I want a warning. Same thing applies to critical. If you
are trying to figure out what to set your levels at, I tend to use the following
formulas:</p>

<ul>
  <li><strong>Warning:</strong>
    <ul>
      <li>1min: 2*(Number of Cores)+1</li>
      <li>5min: (Number of Cores)+1</li>
      <li>15min: (Number of Cores)</li>
    </ul>
  </li>
  <li><strong>Critical:</strong>
    <ul>
      <li>1min: 3*(Number of Cores)</li>
      <li>5min: 2*(Number of Cores)+1</li>
      <li>15min: (Number of Cores)+1</li>
    </ul>
  </li>
</ul>

<p>Once you have your file saved, restart Icinga2, and check the web interface.
Your new check will likely have an <em>Unknown</em> Status in purple, just click on
the check, and manually run it by clicking “Check Now” in the right most panel.</p>

<p>With that, we can move on to the next check!</p>

<h3 id="snmp-memory">SNMP-Memory</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//
// Service Declaration Block
// Service:     SNMP-Memory
// Description: Uses SNMP commands to check status of RAM
//              and swap on the device.
//
object Service "snmp-memory" {
    host_name      = "djehuti.zyradyl.org"
    // Set the Memory warning for Ram and swap Respectively.
    // Uses percents.
    vars.snmp_warn = "50,0"
    vars.snmp_crit = "80,0"
    check_command  = "snmp-memory"
}
</code></pre></div></div>

<p>The warning and critical values are expressed as percentages of the total
amount of their applicable setting. The first one applies to RAM and the second
value corresponds to swap. Restart Icinga2 and log on to the web interface to
check that the new service works.</p>

<h3 id="snmp-storage">SNMP-Storage</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//
// Service Declaration Block
// Service:     SNMP-Storage
// Description: Uses SNMP commands to check the status of disk
//              storage space.
//
object Service "snmp-storage" {
    host_name              = "djehuti.zyradyl.org"
    // Uses percents.
    vars.snmp_warn         = "50"
    vars.snmp_crit         = "80"
    // Specify which partition to monitor
    vars.snmp_storage_name = "/root.dev"
    check_command          = "snmp-storage"
}
</code></pre></div></div>

<p>The <code class="highlighter-rouge">snmp_storage_name</code> variable is used to specify which device you want to
check the status of. If you aren’t sure which device you need to check, set
it to blank, then let it run. It will return a list of partitions that you can
check. Simply enter the name into that variable and you are good to go.</p>

<p>Just as memory, <code class="highlighter-rouge">snmp-storage</code> uses percent values in the warning and critical
threshold variables.</p>

<h3 id="snmp-interfaces">SNMP-Interfaces</h3>

<p>I personally like to specify a different service block for each interface
that I am monitoring, so I am not sure if it is possible to mix interfaces
together, but I don’t see any reason it wouldn’t be possible. I’m going to
list the interface configurations below, and if any variables need to be
explained I will do that below the code.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//
// Service Declaration Block
// Service:     SNMP-Interface
// Description: Uses SNMP commands to check the status of
//              various network interfaces on device.
//
object Service "snmp-int-lan" {
    host_name                      = "djehuti.zyradyl.org"
    // Define interface variables.
    vars.snmp_interface            = "eth0"
    vars.snmp_interface_label      = "LAN"
    vars.snmp_interface_perf       = "true"
    vars.snmp_interface_bits_bytes = "true"
    vars.snmp_interface_megabytes  = "true"
    vars.snmp_interface_noregexp   = "true"
    vars.snmp_warncrit_percent     = "true"
    // Set warning and crits to 100 to disable.
    vars.snmp_warn                 = "100,100"
    vars.snmp_crit                 = "100,100"
    check_command                  = "snmp-interface"
}

//
// Service Declaration Block
// Service:     SNMP-Interface
// Description: Uses SNMP commands to check the status of
//              various network interfaces on device.
//
object Service "snmp-int-wan" {
    host_name                      = "djehuti.zyradyl.org"
    // Define interface variables.
    vars.snmp_interface            = "eth1"
    vars.snmp_interface_label      = "WAN"
    vars.snmp_interface_perf       = "true"
    vars.snmp_interface_bits_bytes = "true"
    vars.snmp_interface_megabytes  = "true"
    vars.snmp_interface_noregexp   = "true"
    vars.snmp_warncrit_percent     = "true"
    // Set warning and crits to 100 to disable.
    vars.snmp_warn                 = "100,100"
    vars.snmp_crit                 = "100,100"
    check_command                  = "snmp-interface"
}

//
// Service Declaration Block
// Service:     SNMP-Interface
// Description: Uses SNMP commands to check the status of
//              various network interfaces on device.
//
object Service "snmp-int-dmz" {
    host_name                      = "djehuti.zyradyl.org"
    // Define interface variables.
    vars.snmp_interface            = "eth2"
    vars.snmp_interface_label      = "DMZ"
    vars.snmp_interface_perf       = "true"
    vars.snmp_interface_bits_bytes = "true"
    vars.snmp_interface_megabytes  = "true"
    vars.snmp_interface_noregexp   = "true"
    vars.snmp_warncrit_percent     = "true"
    // Set warning and crits to 100 to disable.
    vars.snmp_warn                 = "100,100"
    vars.snmp_crit                 = "100,100"
    check_command                  = "snmp-interface"
}
</code></pre></div></div>

<p>So a few things in here need some explanation. The variable
<code class="highlighter-rouge">vars.snmp_interface</code> specifies which interface we will be checking.
<code class="highlighter-rouge">vars.snmp_interface_noregexp</code> is related to this in that it tells icinga2
to not use regex matching. <code class="highlighter-rouge">vars.snmp_interface_label</code> configures a label
that will be shown in the console. <code class="highlighter-rouge">vars.snmp_interface_megabytes</code>, and
<code class="highlighter-rouge">vars.snmp_interface_bits_bytes</code> tells Icinga2 that we want to see bandwidth
measured in megabits. These variables can be adjusted accordingly. Finally,
<code class="highlighter-rouge">vars.snmp_interface_perf</code> tells Icinga2 that we want to monitor bandwidth
usage.</p>

<p>As for warning and critical values, while I like to monitor my bandwidth, I
don’t actually care how high it goes, at least not at the moment. More relevant
than that is the fact that my bandwidth is much less than a gigabit, but let’s
move on from that. <code class="highlighter-rouge">vars.snmp_warncrit_percent</code> says that we are going to
specify our warning and critical thresholds as a percent of total available
bandwidth on that port. I then set <code class="highlighter-rouge">vars.snmp_warn</code>, and <code class="highlighter-rouge">vars.snmp_crit</code> to
100 so that it is effectively disabled.</p>

<p>Once activating these services, you should reset Icinga2. It is worth noting
that you will first get a pending, and then an unknown status for about five
minutes, depending on your check time. Icinga compares the newest reading to
a previous reading that is sufficently old enough, which is usually about five
minutes, to calculate what has changed. Until you have a row in the database
that is the proper age, you will get a big <em>Unknown</em> status. Nothing to worry
about, check back in a half hour.</p>

<h2 id="conclusion">Conclusion</h2>
<p>There is one more snmp check that is available, and that is the process check.
While I previously used this setup on my core router, it ended up causing some
rather wonky effects, so I have elected to not use it. This check would be
useful to monitor the status of a mission critical process, such as a webserver
or even a database server. It works by searching the process list for the number
of times a string appears, and then going from there. I may cover this in the
future, but I won’t be at the moment.</p>

<p>Thank you for reading, and I hope to have part five up with less of a lag time.
I am also planning to do Icinga2 integration with slack soon, so stay tuned
for that!</p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/08/22/HughesNet-And-PMTUD/">
        HughesNet Gen4 and IPv6 PMTUD: A Tragedy
      </a>
    </h1>

    <span class="post-date">22 Aug 2015</span>

    <p>So before I went to bed last night I started experiencing some very odd issues
with my connection. I could connect to Skype, but I couldn’t visit twitter.
I could talk to Google, but not GitHub. I was able to ping my HT1100 gateway,
but my Icinga2 monitoring system reported a socket timeout of longer than 10
seconds on HTTP.</p>

<p>I spent about three hours on it before I finally went to bed. I even went as
far as to spend five more dollars to purchase a 500MB token in order to see
if maybe I was being penalized for using too much data in my throttled state,
as I have been making use of aria2 to manage large downloads that would
otherwise suffer from a mysterious decryption failure when I was downloading
via HTTPS. Didn’t help.</p>

<p>This morning I bit the bullet and changed my LAN’s MTU from 1280 to 1500.
You may be wondering why I refer to this as having to bite the bullet, since
an MTU of 1500 is standard. Well, come to find out that PMTUD is broken on
HughesNet. Something about what is done on the HughesNet side causes the
packets to become too large. Now, IPv6 is supposed to handle this by sending
ICMPv6 Type 2 “Packet too Large” notices to the end point. While debugging
PMTUD the other day (about a week ago) I set up my firewall so that <strong>ALL</strong>
ICMPv6 is allowed, rather than having to itemize the different types. Still,
no good. I was getting silent failures that I had to use test-ipv6.com to
resolve, and they still indicated packets were becoming too large for my
connection. In a fit of irritation, I set my entire LAN to an MTU of 1280.
Eureka, I have IPv6 functionality.</p>

<p>Obviously after last night, I can’t exactly use that solution anymore, for
a reason I have yet to understand. So my MTU is set back to 1500, and without
using HughesNet’s squid proxy (what they call web acceleration), IPv6 fails.
Oh, I didn’t mention that did I? Yeah, their web acceleration lets IPv6 work.
However, I run my own squid proxy, locally, which is even faster than theirs.
It also saves me bandwidth. So I keep web acceleration off.</p>

<ul>
  <li>Web Acceleration On = PMTUD works, IPv6 BUT I have double caching. Not good.</li>
  <li>Web Acceleration Off = IPv6 Fails. Not acceptable.</li>
</ul>

<p>Just to see if I could get something reset in the modem, I even called tech
support. The solution of “It is a problem with your LAN” was obvious, but still
frustrating due to the issues described above. However, I am planning to reach
out to their support today via social media, so I am pushing this article live,
without links, just so I have something to refer to. I will come back to link
to the major terms in this a little later. Wish me luck.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/08/18/As-An-Example/">
        Just as an example..
      </a>
    </h1>

    <span class="post-date">18 Aug 2015</span>

    <p>of what I mean when I say I spend my time meddling in software or hardware
that I really don’t have any business meddling in, I’ve got this website
split into two branches now: Master, and Development. I do all my work in
development, then push to remote. Travis-CI then pulls the changes and builds
them, then runs HTML-Proofer over the output, and then sends me an e-mail
if something is broken. If nothing is broken, then I rebase my Development
branch on master, and then merge it into master to make sure my changes are
preserved.</p>

<p>I guess it should read “I meddle in software that I don’t need in the
slightest.”</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page/4/">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page/2/">Newer</a>
    
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script src='/public/js/script.js'></script>
  </body>
</html>
